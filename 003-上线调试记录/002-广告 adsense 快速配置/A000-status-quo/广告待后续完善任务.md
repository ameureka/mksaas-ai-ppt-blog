  🚀 后续执行计划

  鉴于代码实现已基本完成，后续工作主要集中在验证和部署配置上，而不需要进行大规模的代码编写。

  第一阶段：基础设施准备 (立刻执行)

   1. 数据库迁移:
       * 下载广告功能依赖于新的数据库表 (ad_watch_record, user_download_history)。
       * 行动: 请运行项目的数据库迁移命令（如 pnpm db:push 或 pnpm db:migrate），确保数据库 Schema 与代码同步。

   2. 环境变量配置:
       * 检查 .env 文件，确保 NEXT_PUBLIC_ADSENSE_PUBLISHER_ID 和各个 Slot ID 已填入（如果是测试环境，可先保持为空或使用测试 ID）。

  第二阶段：功能验证 (本地测试)

   1. 验证 PPT 广告位:
       * 运行项目，访问 /ppt 和 /ppt/123。
       * 确认在开发环境下能看到“广告位”占位符或 Mock 的原生广告卡片。
       * 检查控制台日志，确认 NativeAdCard 的 onImpression 事件是否触发。

   2. 验证下载广告流程:
       * 在 PPT 详情页点击“下载”。
       * 选择“观看广告下载”。
       * 验证倒计时结束后，是否成功获得积分并生成下载链接。

  第三阶段：上线前配置 (部署时执行)

   1. 更新 `public/ads.txt`:
       * 将 pub-XXXXXXXXXXXXXXXX 替换为真实的 AdSense Publisher ID。

   2. 生产环境构建:
       * 运行 pnpm build 确保没有类型错误（特别是新添加的 API 路由和组件）。

  📝 文件级更新意见

  由于代码已非常完善，我仅建议进行以下微小的检查/更新：

