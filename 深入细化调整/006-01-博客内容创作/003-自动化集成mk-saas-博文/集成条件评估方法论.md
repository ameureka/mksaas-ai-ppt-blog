# 003 阶段 - MkSaaS 博文集成条件评估方法论

> 创建时间：2025-12-02
> 目的：定义判断博文是否具备与 MkSaaS 集成条件的标准方法

## 一、评估框架

```
┌─────────────────────────────────────────────────────────────┐
│                    集成条件评估                              │
├─────────────────────────────────────────────────────────────┤
│  1. 结构兼容性    →  文件格式、目录结构、命名约定            │
│  2. 数据完整性    →  Frontmatter 字段、必填项               │
│  3. 依赖完备性    →  分类、作者、图片资源                   │
│  4. 发布就绪性    →  内容质量、发布状态                     │
└─────────────────────────────────────────────────────────────┘
```

## 二、评估维度详解

### 2.1 结构兼容性

**检查目标**：确保新内容与现有系统的文件结构一致

| 检查项 | 标准 | 检查命令 |
|--------|------|----------|
| 文件格式 | `.mdx` 扩展名 | `find content/blog -name "*.mdx"` |
| 命名约定 | 中文 `.zh.mdx`，英文 `.mdx` | `ls *.zh.mdx` / `ls *.mdx` |
| 目录结构 | 放置在 `content/blog/` 下 | `ls -la content/blog/` |
| 图片路径 | 使用 `/images/blog/` 前缀 | `grep "image:" file.mdx` |

**参考现有结构**：
```
content/blog/
├── algorithm.mdx        # 英文版
├── algorithm.zh.mdx     # 中文版
├── ppt/                 # 新增 PPT 博客目录
│   ├── marketing/
│   ├── business/
│   └── ...
```

### 2.2 数据完整性

**检查目标**：确保 Frontmatter 包含所有必需字段

**MkSaaS 博客 Frontmatter 规范**：
```yaml
---
title: 文章标题              # 必填
description: 文章描述        # 必填
image: /images/blog/xxx.png  # 必填，封面图
date: "2025-01-01"          # 必填，发布日期
published: true             # 必填，发布状态
categories: [category-slug] # 必填，分类数组
author: author-id           # 必填，作者 ID
tags: [tag1, tag2]          # 可选，标签
seoKeywords: [kw1, kw2]     # 可选，SEO 关键词
relatedPosts: [slug1]       # 可选，相关文章
---
```

**检查命令**：
```bash
# 检查必填字段
head -20 content/blog/xxx.mdx | grep -E "^(title|description|image|date|published|categories|author):"
```

### 2.3 依赖完备性

**检查目标**：确保所有引用的资源都存在

#### 2.3.1 分类依赖

**检查方法**：
```bash
# 1. 获取博客使用的分类
grep -h "categories:" content/blog/**/*.mdx | sort | uniq

# 2. 获取已定义的分类
ls content/category/*.mdx

# 3. 对比找出缺失分类
```

**分类文件格式** (`content/category/xxx.zh.mdx`)：
```yaml
---
name: 分类中文名
description: 分类描述
---
```

#### 2.3.2 作者依赖

**检查方法**：
```bash
# 检查作者是否在系统中定义
grep "author:" content/blog/**/*.mdx | cut -d: -f3 | sort | uniq
```

#### 2.3.3 图片依赖

**检查方法**：
```bash
# 1. 获取博客引用的图片
grep "image:" content/blog/**/*.mdx | cut -d: -f3

# 2. 检查图片是否存在
ls public/images/blog/
```

### 2.4 发布就绪性

**检查目标**：确保内容质量达到发布标准

| 检查项 | 标准 | 状态 |
|--------|------|------|
| `published` 字段 | 设为 `true` | 必须 |
| 标题完整性 | 无占位符 `[TRANSLATED]` | 必须 |
| 描述完整性 | 70-160 字符 | 建议 |
| 内容质量 | 通过 SEO 审计 | 建议 |

## 三、评估流程

```
┌──────────────┐
│  开始评估    │
└──────┬───────┘
       ▼
┌──────────────┐     ❌
│ 1.结构兼容性 │────────→ 修复文件格式/命名
└──────┬───────┘
       │ ✅
       ▼
┌──────────────┐     ❌
│ 2.数据完整性 │────────→ 补充 Frontmatter
└──────┬───────┘
       │ ✅
       ▼
┌──────────────┐     ❌
│ 3.依赖完备性 │────────→ 创建缺失分类/资源
└──────┬───────┘
       │ ✅
       ▼
┌──────────────┐     ❌
│ 4.发布就绪性 │────────→ 修改发布状态/内容
└──────┬───────┘
       │ ✅
       ▼
┌──────────────┐
│  可以集成 ✅  │
└──────────────┘
```

## 四、自动化评估脚本

```bash
#!/bin/bash
# integration-check.sh - MkSaaS 博文集成条件检查

echo "=== MkSaaS 博文集成条件评估 ==="

# 1. 结构兼容性
echo -e "\n[1] 结构兼容性"
echo "  MDX 文件数: $(find content/blog -name '*.mdx' | wc -l)"
echo "  中文文件: $(find content/blog -name '*.zh.mdx' | wc -l)"
echo "  英文文件: $(find content/blog -name '*.mdx' ! -name '*.zh.mdx' | wc -l)"

# 2. 数据完整性
echo -e "\n[2] 数据完整性"
missing_fields=0
for f in content/blog/**/*.zh.mdx; do
  for field in title description image date published categories author; do
    if ! grep -q "^$field:" "$f" 2>/dev/null; then
      echo "  缺失 $field: $f"
      ((missing_fields++))
    fi
  done
done
echo "  缺失字段数: $missing_fields"

# 3. 依赖完备性
echo -e "\n[3] 依赖完备性"
# 检查分类
used_cats=$(grep -rh "  - " content/blog/**/*.zh.mdx 2>/dev/null | grep -E "^  - [a-z-]+$" | sed 's/  - //' | sort | uniq)
for cat in $used_cats; do
  if [ ! -f "content/category/$cat.mdx" ]; then
    echo "  缺失分类: $cat"
  fi
done

# 4. 发布就绪性
echo -e "\n[4] 发布就绪性"
unpublished=$(grep -l "published: false" content/blog/**/*.mdx 2>/dev/null | wc -l)
echo "  未发布文章: $unpublished"
translated_placeholder=$(grep -l "\[TRANSLATED\]" content/blog/**/*.mdx 2>/dev/null | wc -l)
echo "  含翻译占位符: $translated_placeholder"

echo -e "\n=== 评估完成 ==="
```

## 五、当前评估结果 (2025-12-02)

### 5.1 结构兼容性 ✅

| 检查项 | 结果 |
|--------|------|
| 文件格式 | ✅ 全部 `.mdx` |
| 命名约定 | ✅ 中文 `.zh.mdx`，英文 `.mdx` |
| 目录结构 | ✅ `content/blog/ppt/` |
| 图片路径 | ✅ `/images/blog/ppt/` |

### 5.2 数据完整性 ✅

| 字段 | 结果 |
|------|------|
| title | ✅ 全部存在 |
| description | ✅ 全部存在 |
| image | ✅ 全部存在 |
| date | ✅ 全部存在 |
| published | ✅ 全部存在 (值为 false) |
| categories | ✅ 全部存在 |
| author | ✅ 全部存在 |

### 5.3 依赖完备性 ⚠️

| 依赖项 | 结果 | 说明 |
|--------|------|------|
| marketing | ✅ | 已存在 |
| business | ✅ | 已存在 |
| year-end | ✅ | 已存在 |
| education | ✅ | 已存在 |
| report | ✅ | 已存在 |
| proposal | ✅ | 已存在 |
| general | ✅ | 已存在 |
| **paid-search** | ❌ | **需要创建** |
| 图片资源 | ✅ | 402 张已部署 |
| 作者 (fox) | ✅ | 已存在 |

### 5.4 发布就绪性 ⚠️

| 检查项 | 结果 | 说明 |
|--------|------|------|
| published 状态 | ⚠️ | 全部为 `false`，需改为 `true` |
| 英文标题 | ⚠️ | 含 `[TRANSLATED]` 占位符 |
| 内容质量 | ✅ | 通过 SEO 审计 |

## 六、集成前修复清单

### 6.1 必须修复

1. **创建 `paid-search` 分类**
   ```bash
   # content/category/paid-search.mdx
   ---
   name: Paid Templates & Search
   description: Guides for finding and using premium PPT templates
   ---
   
   # content/category/paid-search.zh.mdx
   ---
   name: 付费模板与搜索
   description: 付费 PPT 模板的选购与搜索技巧指南
   ---
   ```

2. **修改发布状态**
   ```bash
   find content/blog/ppt -name "*.mdx" -exec sed -i '' 's/published: false/published: true/' {} \;
   ```

3. **移除翻译占位符**
   ```bash
   find content/blog/ppt -name "*.mdx" ! -name "*.zh.mdx" -exec sed -i '' 's/\[TRANSLATED\] //' {} \;
   ```

### 6.2 建议优化

- 调用真实翻译 API 生成英文内容
- 优化过短标题 (108 个)
- 增加正文图片 (200 个文章)

## 七、集成验证命令

```bash
# 集成后验证
pnpm build  # 构建项目，检查是否有错误
pnpm dev    # 启动开发服务器，访问博客页面验证
```

## 八、总结

**集成条件评估的核心方法论**：

1. **对标现有系统** - 分析现有博客的文件结构、Frontmatter 格式、依赖关系
2. **逐项检查** - 按结构、数据、依赖、发布四个维度系统检查
3. **差异分析** - 找出新内容与现有系统的差异点
4. **修复清单** - 生成明确的修复任务列表
5. **验证闭环** - 修复后重新验证，确保所有条件满足

**当前状态**：具备 90% 集成条件，需完成 3 项必须修复后即可集成。
