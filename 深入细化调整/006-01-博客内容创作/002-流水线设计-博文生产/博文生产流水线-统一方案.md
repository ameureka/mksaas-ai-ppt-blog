# 博文生产流水线 - 统一方案

> 更新时间：2025-12-02
> 合并自：博客优化综合方案.md、博客综合处理方案-执行细节.md、博客综合处理方案-gpt.md

---

## 一、目标概览

| 项目 | 说明 |
|------|------|
| 输入 | 100 篇 MDX 草稿（广告-博文/） |
| 输出 | 200 篇优化后的 MDX（中英文各 100 篇） |
| 核心任务 | 审计 → 修复 → 翻译 → 图片 → 同步 → 验收 |

### 输入状态

```
100 篇草稿
├── categories: [product]  ❌ 分类错误
├── image: /images/blog/post-*.png  ❌ 占位图
├── 无内部/外部链接  ❌
├── 无权威引用  ❌
├── 无英文版本  ❌
└── published: false  ❌
```

### 输出状态

```
200 篇优化后
├── categories: [business/marketing/...]  ✅ 正确分类
├── image: /images/blog/{slug}-cover.jpg  ✅ 真实封面
├── 内部链接 ≥3，外部链接 ≥1  ✅
├── 权威引用 ≥2，统计数据 ≥2  ✅
├── 中英文双版本  ✅
└── published: true  ✅
```

---

## 二、分类映射表

| 中文分类 | 英文 Slug | 配色 | 风格 |
|----------|-----------|------|------|
| 商务汇报 | business | 深蓝/灰/白 | 极简网格、科技光影 |
| 年终总结 | year-end | 暖橙/金/米 | 时间线+图表、稳重 |
| 教育培训 | education | 绿/蓝/黄 | 明快、插画人物 |
| 培训课件 | training | 蓝/灰/白 | 企业风、专业 |
| 产品营销 | marketing | 粉/紫/青 | 高对比、渐变霓虹 |
| 营销方案 | marketing-plan | 橙/蓝/白 | 策略图、数据驱动 |
| 项目提案 | proposal | 蓝/绿/白 | 创新、技术感 |
| 述职报告 | report | 深灰/石墨/白 | 专业、成就导向 |
| 通用技巧 | general | 蓝/绿/黄 | 多功能、信息图 |
| 付费与搜索 | paid-search | 紫/粉/青 | 现代、资源导向 |

---

## 三、SEO/GEO 审核规则

### 3.1 必检项

| 检查项 | 规则 | 阈值 |
|--------|------|------|
| 标题长度 | 中文字符 | 25-35 字 |
| 描述长度 | 中文字符 | 70-100 字 |
| H2 标题数 | 结构完整 | ≥5 个 |
| H3 标题数 | 细节丰富 | ≥5 个 |
| 内部链接 | 站内互链 | ≥3 个 |
| 外部链接 | 权威来源 | ≥1 个 |
| 图片数量 | 配图丰富 | ≥3 张 |
| 字数 | 内容充实 | ≥1200 字 |
| 日期格式 | 标准格式 | YYYY-MM-DD |

### 3.2 GEO 增强项

| 检查项 | 规则 | 阈值 |
|--------|------|------|
| 权威引用 | 含来源标注 | ≥2 条 |
| 统计数据 | 含百分比/数字 | ≥2 条 |
| FAQ 段落 | 常见问题 | 存在 |
| 图片 alt | 描述完整 | 非空 |

### 3.3 Issues 枚举

```typescript
type Issue =
  | 'short_title'        // 标题过短
  | 'long_title'         // 标题过长
  | 'short_desc'         // 描述过短
  | 'no_cover'           // 缺少封面
  | 'few_images'         // 图片不足
  | 'no_internal_links'  // 无内部链接
  | 'no_external_links'  // 无外部链接
  | 'no_authoritative_quote' // 无权威引用
  | 'no_stats'           // 无统计数据
  | 'few_h2'             // H2 不足
  | 'few_h3'             // H3 不足
  | 'no_faq'             // 缺少 FAQ
  | 'low_word_count'     // 字数不足
  | 'wrong_category'     // 分类错误
  | 'missing_en'         // 缺少英文版
  | 'bad_date';          // 日期格式错误
```

---

## 四、六阶段流水线

### 阶段 A：审计与缺口定位

**目标**：扫描所有 MDX，生成问题报告

**输入**：`广告-博文/**/*.zh.mdx`

**输出**：`reports/blog-audit.json`

**命令**：`pnpm blog:audit`

**检查内容**：
- Frontmatter 完整性
- 标题/描述长度
- 正文结构（H2/H3/字数）
- 链接数量（内部/外部）
- 图片数量和 alt
- 权威引用和统计数据
- FAQ 段落存在性

---

### 阶段 B：批量修复

**目标**：修复 Frontmatter 和正文内容

#### B1. Frontmatter 修复

| 修复项 | 操作 |
|--------|------|
| fix-category | 中文分类 → 英文 slug |
| fix-date | 日期格式 → YYYY-MM-DD |
| fix-image | 占位图 → /images/blog/{slug}-cover.jpg |
| fix-tags | 自动生成 tags |
| fix-keywords | 自动生成 seoKeywords |
| fix-related | 自动推荐 relatedPosts |

#### B2. 正文修复

| 修复项 | 操作 |
|--------|------|
| fix-internal-links | 插入 ≥3 个内部链接 |
| fix-external-links | 插入 ≥1 个外部链接 |
| fix-authority | 插入 ≥2 条权威引用 |
| fix-stats | 插入 ≥2 条统计数据 |
| fix-faq | 生成 FAQ 段落 |
| fix-cta | 生成 CTA 段落 |
| fix-images | 插入图片占位符 |

**命令**：`pnpm blog:fix --type <fix-type>`

---

### 阶段 C：质量复核

**目标**：确认问题清零

**操作**：
1. 复跑 `pnpm blog:audit`
2. 检查 issues 数量
3. 人工抽检重点篇

**验收标准**：
- 核心 issues 清零
- 人工抽检通过

---

### 阶段 D：多语言翻译

**目标**：生成英文版本

**输入**：修复后的 `{slug}.zh.mdx`

**输出**：`{slug}.mdx`（英文版）

**翻译规则**：
- 翻译 title、description、正文
- 保留 date、image、published、author
- categories 按映射表转换
- 组件结构不变
- 图片路径不变
- 内链格式不变

**命令**：`pnpm blog:translate`

---

### 阶段 E：图片生成

**目标**：生成封面 + 内页图

**规格**：

| 类型 | 尺寸 | 格式 | 大小 |
|------|------|------|------|
| 封面 | 1200×630 | JPG | <200KB |
| 内页 | 1000×600 | PNG | <150KB |

**命名**：
- 封面：`/images/blog/{slug}-cover.jpg`
- 内页：`/images/blog/{slug}-{n}.png`

**与 001 阶段整合**：
- 使用 `draft-code/data/pending-prompts.md` 的 Prompt
- 手工用 Gemini 生成
- 压缩后放入 `public/images/blog/`

---

### 阶段 F：同步与验收

**目标**：同步到正式目录，最终验收

**同步操作**：
1. 复制到 `content/blog/`
2. 更新索引
3. 设置 `published: true`

**验收检查**：
1. `pnpm content` 通过
2. `pnpm lint` 通过
3. 图片路径无 404
4. 中英文文件配对
5. 分类映射正确



---

## 五、数据结构

### 5.1 审计报告结构

```typescript
interface BlogAuditReport {
  generatedAt: string;
  totalFiles: number;
  passedFiles: number;
  failedFiles: number;
  files: BlogAuditItem[];
}

interface BlogAuditItem {
  slug: string;
  locale: 'zh' | 'en';
  filePath: string;
  issues: Issue[];
  stats: {
    wordCount: number;
    h2Count: number;
    h3Count: number;
    internalLinks: number;
    externalLinks: number;
    imageCount: number;
    titleLength: number;
    descLength: number;
    authorityQuotes: number;
    statsCount: number;
  };
  frontmatter: {
    title: string;
    description: string;
    date: string;
    categories: string[];
    author: string;
    image: string;
    published: boolean;
  };
}
```

### 5.2 索引结构

```typescript
interface BlogIndex {
  slug: string;
  locale: 'zh' | 'en';
  title: string;
  description: string;
  date: string;
  categories: string[];
  tags: string[];
  seoKeywords: string[];
  image: string;
  wordCount: number;
  internalLinks: number;
  externalLinks: number;
  status: 'ok' | 'needs_fix';
  mediaStatus: 'none' | 'partial' | 'done';
  issues: Issue[];
}

interface BlogMedia {
  slug: string;
  cover: string | null;
  inlineImages: string[];
  generatorModel?: string;
}
```

---

## 六、分类差异化策略

### 6.1 视觉风格

| 分类 | 配色 | 元素 | 调性 |
|------|------|------|------|
| 商务汇报 | 深蓝/灰 | 数据看板、折线图 | 决策支持、复盘 |
| 年终总结 | 暖橙/金 | 时间线、里程碑 | 成绩、复盘、计划 |
| 教育培训 | 绿/蓝/黄 | 课堂、书本、卡片 | 互动、易学 |
| 产品营销 | 粉/紫/青 | 营销漏斗、产品展示 | 转化、亮点 |
| 项目提案 | 蓝/绿 | 灯泡、路线图 | 创新、前瞻 |
| 述职报告 | 深灰/石墨 | 职业成长、成果图表 | 专业、可信 |
| 通用技巧 | 蓝/绿/黄 | 工具、流程、清单 | 实用、通用 |

### 6.2 内链策略

| 优先级 | 策略 |
|--------|------|
| 1 | 同分类互链（如商务汇报类文章互链） |
| 2 | 跨分类主题互链（如"页数规划"主题互链） |
| 3 | 相关标签互链 |

### 6.3 FAQ/CTA 定制

| 分类 | FAQ 主题 | CTA 引导 |
|------|----------|----------|
| 商务汇报 | 决策层关注、风险/ROI | 下载模板、查看案例 |
| 年终总结 | 证据链、数据来源 | 使用模板、填充清单 |
| 教育培训 | 课前准备、互动页 | 课程模板合集 |
| 产品营销 | 转化率、素材复用 | 营销方案合集 |
| 述职报告 | 成绩不够好怎么办 | 述职模板、技巧 |
| 项目提案 | ROI 计算、风险评估 | BP 案例、提案模板 |

---

## 七、命令清单

| 命令 | 说明 | 状态 |
|------|------|------|
| `pnpm blog:audit` | 审计脚本，生成问题报告 | ✅ 已实现 |
| `pnpm blog:fix` | 修复脚本，修复 Frontmatter/正文 | ✅ 已实现 |
| `pnpm blog:translate` | 翻译脚本，生成英文版 | ✅ 已实现 |
| `pnpm blog:image-tasks` | 图片任务生成 | ✅ 已实现 |
| `pnpm blog:sync` | 同步到 content/blog/ | ✅ 已实现 |
| `pnpm blog:validate` | 验收检查 | ✅ 已实现 |
| `pnpm content` | Schema 校验 | ✅ 已有 |
| `pnpm lint` | 代码检查 | ✅ 已有 |

---

## 八、文件结构

```
draft-code/
├── config/
│   ├── category-map.ts         # 分类映射
│   └── category-styles.ts      # 分类风格
├── scripts/
│   ├── blog-audit/             # 审计脚本
│   ├── blog-fix/               # 修复脚本
│   ├── blog-translate/         # 翻译脚本
│   ├── blog-image-tasks/       # 图片任务
│   ├── blog-sync/              # 同步脚本
│   └── blog-validate/          # 验收脚本
├── reports/
│   ├── blog-audit.json         # 审计报告
│   └── blog-audit-summary.md   # 审计摘要
└── data/
    ├── image-tasks.json        # 图片任务
    └── pending-prompts.md      # 待处理 Prompt
```

---

## 九、执行顺序

### 第一轮：审计

```bash
cd draft-code
pnpm blog:audit
# 输出：reports/blog-audit.json
```

### 第二轮：修复

```bash
# 修复 Frontmatter
pnpm blog:fix --type fix-category
pnpm blog:fix --type fix-date
pnpm blog:fix --type fix-image

# 修复正文
pnpm blog:fix --type fix-internal-links
pnpm blog:fix --type fix-authority
pnpm blog:fix --type fix-faq
```

### 第三轮：复核

```bash
pnpm blog:audit
# 确认 issues 减少
```

### 第四轮：翻译

```bash
pnpm blog:translate
# 生成英文版
```

### 第五轮：图片

```bash
# 使用 001 阶段的 Prompt
# 手工用 Gemini 生成
# 压缩后放入 public/images/blog/
```

### 第六轮：同步验收

```bash
pnpm blog:sync
pnpm blog:validate
pnpm content
pnpm lint
```

---

## 十、验收标准

| 检查项 | 标准 |
|--------|------|
| 分类正确 | 100% 使用英文 slug |
| 封面图存在 | 100% 有真实封面 |
| 内部链接 | 100% ≥3 个 |
| 权威引用 | 100% ≥2 条 |
| 英文版存在 | 100% 有配对文件 |
| Schema 通过 | `pnpm content` 无错误 |
| Lint 通过 | `pnpm lint` 无错误 |
| 图片无 404 | 所有图片路径可访问 |

---

## 十一、与 001 阶段整合

| 001 阶段产出 | 002 阶段使用 |
|--------------|--------------|
| `pending-prompts.md` | 图片生成 Prompt |
| `image-tasks.json` | 图片任务数据 |
| `category-styles.ts` | 分类风格配置 |
| `prompt-templates.ts` | Prompt 模板 |

**整合点**：
- 002 的 `blog-image-tasks` 脚本可直接使用 001 的 `image-tasks.json`
- 图片生成后更新 002 的 `mediaStatus`

