📊 Gemini 手工图片生成流水线 - 完整设计方案（最终版）
一、方案概览
| 项目 | 说明 | |------|------| | 目标 | 为 100 篇博文生成内容强关联的配套图片 | | 工具 | Gemini 网页/客户端（手工复制粘贴） | | 产出 | 500 张图片（200 封面 + 300 内页） | | 核心特点 | Prompt 与文章内容深度关联，非通用模板 | | 预计时间 | 17-20 小时 |

二、流水线架构
┌─────────────────────────────────────────────────────────────────┐
│              Gemini 手工图片生成流水线（最终版）                  │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Phase 1: 内容分析与 Prompt 生成（脚本自动）                     │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │ MDX 文件    │    │ 内容分析器  │    │ Prompt      │         │
│  │ (100篇)     │ -> │ ・标题提取  │ -> │ 生成器      │         │
│  │             │    │ ・H2 解析   │    │ ・封面×2    │         │
│  │             │    │ ・段落分析  │    │ ・内页×3    │         │
│  │             │    │ ・关键词    │    │             │         │
│  └─────────────┘    └─────────────┘    └─────────────┘         │
│        +                   │                   │                │
│  ┌─────────────┐           │                   v                │
│  │ 分类风格    │           │           ┌─────────────┐         │
│  │ 配置        │ ----------┘           │ 输出文件    │         │
│  │ (category-  │                       │ ・prompts.md│         │
│  │  map.ts)    │                       │ ・progress  │         │
│  └─────────────┘                       │ ・tasks.json│         │
│                                        └─────────────┘         │
│                                                                 │
│  Phase 2: 图片生成（人工执行）                                   │
│  ┌─────────────────────────────────────────────────────┐       │
│  │                                                     │       │
│  │   ┌──────────┐    ┌──────────┐    ┌──────────┐     │       │
│  │   │ 复制     │ -> │ Gemini   │ -> │ 筛选     │     │       │
│  │   │ Prompt   │    │ 网页生成 │    │ 下载命名 │     │       │
│  │   └──────────┘    └──────────┘    └──────────┘     │       │
│  │        ^                                 │          │       │
│  │        │         ┌──────────┐            │          │       │
│  │        └─────────│ 进度追踪 │<───────────┘          │       │
│  │                  │ 标记完成 │                       │       │
│  │                  └──────────┘                       │       │
│  │                                                     │       │
│  │   按分类批次执行（保持风格一致）                      │       │
│  │   批次1: 商务汇报(9) → 批次2: 年终总结(10) → ...    │       │
│  │                                                     │       │
│  └─────────────────────────────────────────────────────┘       │
│                                                                 │
│  Phase 3: 后处理（脚本自动）                                     │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │ 图片压缩    │ -> │ 复制到      │ -> │ 更新 MDX    │         │
│  │ JPG<200KB   │    │ public/     │    │ ・封面路径  │         │
│  │ PNG<150KB   │    │ images/blog │    │ ・内页引用  │         │
│  └─────────────┘    └─────────────┘    └─────────────┘         │
│                                                                 │
│  Phase 4: 验收（脚本自动）                                       │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │ blog:audit  │ -> │ 检查清零    │ -> │ mediaStatus │         │
│  │             │    │ ・no_cover  │    │ = done      │         │
│  │             │    │ ・few_images│    │             │         │
│  └─────────────┘    └─────────────┘    └─────────────┘         │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
三、Phase 1: 内容分析与 Prompt 生成
3.1 内容分析流程
┌─────────────────────────────────────────────────────────────┐
│                    MDX 内容分析流程                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  输入：MDX 文件                                              │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ ---                                                 │   │
│  │ title: "产品营销PPT一般包含哪些内容"                 │   │
│  │ description: "详解产品营销PPT的核心组成..."          │   │
│  │ categories: ["marketing"]                           │   │
│  │ tags: ["产品营销", "PPT结构"]                        │   │
│  │ ---                                                 │   │
│  │                                                     │   │
│  │ ## 市场分析与用户画像                                │   │
│  │ 分析目标市场规模、用户需求...                        │   │
│  │                                                     │   │
│  │ ## 产品卖点与竞争优势                                │   │
│  │ 突出产品核心功能、差异化优势...                      │   │
│  │                                                     │   │
│  │ ## 营销策略与执行计划                                │   │
│  │ 制定推广渠道、时间节点...                            │   │
│  └─────────────────────────────────────────────────────┘   │
│                           │                                 │
│                           v                                 │
│  分析步骤：                                                  │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 1. 解析 Frontmatter                                 │   │
│  │    ├── title → 提取短标题（4-6字）                  │   │
│  │    ├── categories → 查找风格配置                    │   │
│  │    ├── tags → 补充关键词                            │   │
│  │    └── description → 提取画面元素                   │   │
│  │                                                     │   │
│  │ 2. 解析正文 H2 结构                                 │   │
│  │    ├── 提取所有 ## 标题                             │   │
│  │    ├── 过滤通用标题（FAQ/总结/结语）                │   │
│  │    └── 取前 3 个作为内页场景                        │   │
│  │                                                     │   │
│  │ 3. 分析段落类型                                     │   │
│  │    ├── 检测列表 → 清单卡片图                        │   │
│  │    ├── 检测步骤 → 流程图                            │   │
│  │    ├── 检测数据 → 图表                              │   │
│  │    ├── 检测对比 → 对比图                            │   │
│  │    └── 其他 → 概念图                                │   │
│  │                                                     │   │
│  │ 4. 提取关键词                                       │   │
│  │    ├── 从 H2 标题提取                               │   │
│  │    ├── 从段落高频词提取                             │   │
│  │    └── 映射为画面元素                               │   │
│  └─────────────────────────────────────────────────────┘   │
│                           │                                 │
│                           v                                 │
│  输出：ArticleAnalysis 对象                                  │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ {                                                   │   │
│  │   slug: "product-marketing-ppt-content",            │   │
│  │   title: "产品营销PPT一般包含哪些内容",              │   │
│  │   shortTitleZh: "产品营销PPT",                      │   │
│  │   shortTitleEn: "Product Marketing PPT",            │   │
│  │   category: "marketing",                            │   │
│  │   style: { colors, elements, tone },                │   │
│  │   coverKeywords: ["产品营销", "PPT结构", "内容"],    │   │
│  │   coverElements: ["产品展示", "结构框架", "模块"],   │   │
│  │   sections: [                                       │   │
│  │     { h2: "市场分析与用户画像",                     │   │
│  │       type: "chart",                                │   │
│  │       elements: ["饼图", "用户画像", "数据"] },     │   │
│  │     { h2: "产品卖点与竞争优势",                     │   │
│  │       type: "cards",                                │   │
│  │       elements: ["功能卡片", "对比", "优势"] },     │   │
│  │     { h2: "营销策略与执行计划",                     │   │
│  │       type: "flow",                                 │   │
│  │       elements: ["漏斗", "时间线", "渠道"] }        │   │
│  │   ]                                                 │   │
│  │ }                                                   │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
3.2 分类风格配置
| 分类 | slug | 短中文 | 短英文 | 配色 | 风格 | 典型元素 | |------|------|--------|--------|------|------|----------| | 商务汇报 | business | 商务汇报PPT | Business Report | 深蓝#1E3A5F + 灰#E2E8F0 + 白 | 极简网格、科技光影 | 数据看板、折线图、会议室 | | 年终总结 | year-end | 年终总结PPT | Year-End Summary | 暖橙#DD6B20 + 金#F6E05E + 米 | 时间线、稳重、成就感 | 里程碑、图表、日历、奖杯 | | 教育培训 | education | 教育培训PPT | Education Training | 绿#38A169 + 蓝#3182CE + 黄 | 明快、高对比、插画 | 书本、课堂、学生、卡片 | | 产品营销 | marketing | 产品营销PPT | Product Marketing | 粉#D53F8C + 紫#805AD5 + 青#38B2AC | 高对比、渐变霓虹 | 营销漏斗、产品展示、数据 | | 项目提案 | proposal | 项目提案PPT | Project Proposal | 蓝#2B6CB0 + 绿#38A169 + 白 | 创新、前瞻、技术感 | 灯泡、路线图、里程碑 | | 述职报告 | report | 述职报告PPT | Work Report | 深灰#2D3748 + 石墨#4A5568 + 白 | 专业、稳重、成就导向 | 职业成长、成果图表 | | 通用技巧 | general | PPT技巧 | PPT Tips | 蓝#4299E1 + 绿#48BB78 + 黄 | 多功能、信息图 | 工具、流程、清单、技巧 | | 付费搜索 | paid-search | 模板搜索 | Template Search | 紫#9F7AEA + 粉#ED64A6 + 青 | 现代、资源导向 | 搜索框、锁/徽章、模板 |

3.3 段落类型判断规则
| 检测特征 | 图片类型 | 画面元素建议 | |----------|----------|--------------| | 包含"步骤"、"流程"、"第一步"、"首先" | 流程图 (flow) | 箭头、步骤卡片、数字标记、流程线 | | 包含"对比"、"vs"、"区别"、"不同" | 对比图 (compare) | 左右分栏、对比表格、VS符号 | | 包含数字、百分比、"数据"、"统计" | 数据图表 (chart) | 饼图、柱状图、趋势线、数据标签 | | 包含列表（-、1.、•）、"要点"、"清单" | 清单卡片 (cards) | 卡片组、图标列表、勾选标记 | | 包含"案例"、"示例"、"场景" | 场景示意 (scene) | 具体场景插画、人物、环境 | | 其他 | 概念图 (concept) | 抽象元素、图标组合、概念可视化 |

3.4 Prompt 模板
封面 Prompt 模板（中文版）

生成 1200x630 的博客封面图。

【文章主题】{title}
【核心关键词】{keywords_from_analysis}

【视觉风格】
- 整体风格：{category_style}
- 配色方案：{primary} + {secondary} + {accent}
- 调性：{tone}

【文字渲染】
- 渲染文字：「{short_title_zh}」
- 字体：现代无衬线、粗体
- 位置：居中
- 颜色：{font_color}（高对比）

【画面元素】
- 主元素：{main_element_from_title}
- 辅助元素：{elements_from_description}
- 分类元素：{elements_from_category}

【构图】
- 简洁大气，文字区域留白充足
- 适合社交媒体缩略图

【要求】
- 尺寸：1200x630
- 无水印、无多余文字、高清
封面 Prompt 模板（英文版）

Generate a 1200x630 blog cover image.

【Topic】{title_en}
【Keywords】{keywords_en}

【Visual Style】
- Style: {category_style_en}
- Colors: {primary} + {secondary} + {accent}
- Tone: {tone_en}

【Text Rendering】
- Text: "{short_title_en}"
- Font: Modern sans-serif, bold
- Position: Centered
- Color: {font_color} (high contrast)

【Visual Elements】
- Main: {main_element_en}
- Supporting: {elements_en}
- Category: {category_elements_en}

【Composition】
- Clean, spacious text area
- Social media thumbnail friendly

【Requirements】
- Size: 1200x630
- No watermark, no extra text, high quality
内页 Prompt 模板

生成 1000x600 的博客配图。

【对应段落】{h2_title}
【段落主旨】{paragraph_summary}

【图片类型】{image_type}

【场景描述】
{scene_description_based_on_h2_and_content}

【画面元素】
- 主元素：{main_element_from_h2}
- 细节元素：{detail_elements_from_paragraph}
- 装饰元素：{decorative_elements}

【视觉风格】
- 风格：{category_style}（与封面统一）
- 配色：{color_palette}
- 类型：{扁平插画 / 信息图 / 流程图}

【要求】
- 尺寸：1000x600
- 扁平/插画风格
- 简洁清晰，信息可读
- 无水印
- 极少文字（仅短标签）
- 与封面风格统一
3.5 输出文件
| 文件 | 格式 | 内容 | |------|------|------| | image-prompts.md | Markdown | 500 条 Prompt，按分类组织，可直接复制 | | image-progress.md | Markdown | 进度追踪表，500 个 checkbox | | image-tasks.json | JSON | 结构化数据，供后处理脚本使用 |

四、Phase 2: 图片生成（人工执行）
4.1 分批执行计划
| 批次 | 分类 | 篇数 | 封面(中+英) | 内页 | 总图片 | 预计时间 | |------|------|------|-------------|------|--------|----------| | 1 | 商务汇报 | 9 | 18 | 27 | 45 | 1.5h | | 2 | 年终总结 | 10 | 20 | 30 | 50 | 1.7h | | 3 | 教育培训 | 11 | 22 | 33 | 55 | 1.8h | | 4 | 产品营销 | 10 | 20 | 30 | 50 | 1.7h | | 5 | 述职报告 | 10 | 20 | 30 | 50 | 1.7h | | 6 | 项目提案 | 7 | 14 | 21 | 35 | 1.2h | | 7 | 通用技巧 | 24 | 48 | 72 | 120 | 4h | | 8 | 付费搜索 | 19 | 38 | 57 | 95 | 3.2h | | 总计 | | 100 | 200 | 300 | 500 | ~17h |

4.2 单张图操作流程
┌─────────────────────────────────────────────────────────────┐
│                    单张图生成流程                            │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  1. 打开 image-prompts.md                                   │
│     └── 找到当前文章区块                                    │
│                                                             │
│  2. 复制 Prompt                                             │
│     └── 选中代码块内容，Ctrl+C                              │
│                                                             │
│  3. 粘贴到 Gemini 网页                                      │
│     └── 打开 gemini.google.com，粘贴，回车                  │
│                                                             │
│  4. 等待生成                                                │
│     └── 通常 10-30 秒                                       │
│                                                             │
│  5. 筛选结果                                                │
│     ├── 满意 → 继续                                        │
│     └── 不满意 → 点"重新生成" 或 微调 Prompt               │
│                                                             │
│  6. 下载图片                                                │
│     └── 右键保存 / 点下载按钮                               │
│                                                             │
│  7. 按规则命名                                              │
│     ├── 封面中文：{slug}-cover.jpg                         │
│     ├── 封面英文：{slug}-cover-en.jpg                      │
│     └── 内页：{slug}-{n}.png                               │
│                                                             │
│  8. 放入目录                                                │
│     └── generated-images/{category}/                        │
│                                                             │
│  9. 更新进度                                                │
│     └── 在 image-progress.md 标记 ✅                        │
│                                                             │
│  10. 继续下一张                                             │
│                                                             │
└─────────────────────────────────────────────────────────────┘
4.3 文件命名规则
| 类型 | 格式 | 尺寸 | 示例 | |------|------|------|------| | 中文封面 | {slug}-cover.jpg | 1200×630 | ppt-marketing-guide-cover.jpg | | 英文封面 | {slug}-cover-en.jpg | 1200×630 | ppt-marketing-guide-cover-en.jpg | | 内页 1 | {slug}-1.png | 1000×600 | ppt-marketing-guide-1.png | | 内页 2 | {slug}-2.png | 1000×600 | ppt-marketing-guide-2.png | | 内页 3 | {slug}-3.png | 1000×600 | ppt-marketing-guide-3.png |

4.4 质量检查清单
| 检查项 | 封面 | 内页 | |--------|------|------| | 尺寸正确 | 1200×630 | 1000×600 | | 文字清晰可读 | ✓ | 极少/无 | | 风格符合分类 | ✓ | ✓ | | 无水印 | ✓ | ✓ | | 无多余文字 | ✓ | ✓ | | 构图简洁 | ✓ | ✓ | | 与同分类风格一致 | ✓ | ✓ |

五、Phase 3: 后处理（脚本自动）
5.1 图片压缩
输入：generated-images/**/*.{jpg,png}
处理：
  - JPG: quality 85, 确保 <200KB
  - PNG: pngquant 65-80, 确保 <150KB
输出：compressed/**/*.{jpg,png}
5.2 复制到目标目录
输入：compressed/**/*.{jpg,png}
输出：public/images/blog/*.{jpg,png}
5.3 更新 MDX
对每篇 MDX：
1. 更新 frontmatter.image = /images/blog/{slug}-cover.jpg
2. 在正文中插入/替换内页图片引用：
   ![{h2_title}](/images/blog/{slug}-{n}.png)
六、Phase 4: 验收（脚本自动）
6.1 检查项
| 检查 | 通过条件 | |------|----------| | 封面存在 | {slug}-cover.jpg 存在且 <200KB | | 英文封面存在 | {slug}-cover-en.jpg 存在且 <200KB | | 内页 ≥3 | {slug}-1/2/3.png 存在且 <150KB | | MDX 引用正确 | frontmatter.image 指向正确 | | 正文图片引用 | 至少 3 个 ![...] 引用 |

6.2 验收结果
no_cover issue → 0
few_images issue → 0
mediaStatus → done
七、产出物清单
| 阶段 | 文件 | 说明 | |------|------|------| | Phase 1 | image-prompts.md | 500 条内容关联 Prompt | | Phase 1 | image-progress.md | 进度追踪表 | | Phase 1 | image-tasks.json | 结构化任务数据 | | Phase 2 | generated-images/ | 500 张原始图片 | | Phase 3 | public/images/blog/ | 压缩后图片 | | Phase 3 | 更新后的 MDX | 含图片引用 | | Phase 4 | 验收报告 | issues 清零确认 |

八、时间规划
| 阶段 | 执行者 | 时间 | |------|--------|------| | Phase 1 | 脚本 | 5 分钟 | | Phase 2 | 人工 | 17-20 小时 | | Phase 3 | 脚本 | 10 分钟 | | Phase 4 | 脚本 | 5 分钟 | | 总计 | | ~18 小时 |

九、执行建议
按分类批次做 - 同分类连续做，保持风格一致
先做封面 - 封面更重要，优先完成
不满意就重做 - 质量优先，不凑合
及时命名保存 - 避免文件混乱
定期更新进度 - 方便追踪和恢复
分天完成 - 建议每天 5-6 小时，3-4 天完成
这个最终方案可以吗？如果 OK，我就开始实现 Phase 1 的 Prompt 生成脚本。
