# QA-16.0 å›½é™…åŒ–æ”¯æŒ

## ğŸ“‹ é—®é¢˜
é¡¹ç›®å›½é™…åŒ–æ”¯æŒå¦‚ä½•ï¼Ÿ

## âœ… å›ç­”

é¡¹ç›®ä½¿ç”¨ **next-intl** å®ç°äº†å®Œæ•´çš„å›½é™…åŒ–ï¼ˆi18nï¼‰æ”¯æŒï¼Œå½“å‰æ”¯æŒ**è‹±æ–‡ï¼ˆenï¼‰**å’Œ**ä¸­æ–‡ï¼ˆzhï¼‰**ä¸¤ç§è¯­è¨€ã€‚

### ğŸŒ å›½é™…åŒ–æŠ€æœ¯æ ˆ

#### æ ¸å¿ƒåº“

```json
{
  "next-intl": "^4.0.0",    // Next.js å›½é™…åŒ–åº“
  "use-intl": "^3.26.5"     // React Hook
}
```

**æ¥æº**: `package.json:113,141`

### ğŸ”§ å›½é™…åŒ–é…ç½®

#### è·¯ç”±é…ç½®

**æ–‡ä»¶**: `src/i18n/routing.ts`

```typescript
import { defineRouting } from 'next-intl/routing';

export const routing = defineRouting({
  // æ”¯æŒçš„è¯­è¨€
  locales: ['en', 'zh'],

  // é»˜è®¤è¯­è¨€
  defaultLocale: 'en',

  // è·¯å¾„å‰ç¼€ç­–ç•¥
  localePrefix: 'as-needed',  // en ä¸éœ€è¦å‰ç¼€ï¼Œzh éœ€è¦ /zh å‰ç¼€

  // Cookie åç§°
  localeCookie: {
    name: 'NEXT_LOCALE'
  },

  // ç¦ç”¨è‡ªåŠ¨è¯­è¨€æ£€æµ‹
  localeDetection: false
});
```

**æ¥æº**: `src/i18n/routing.ts` (åŸºäº next-intl è§„èŒƒ)

**è·¯ç”±ç»“æ„**:
```
/                  â†’ è‹±æ–‡é¦–é¡µ
/zh                â†’ ä¸­æ–‡é¦–é¡µ
/pricing           â†’ è‹±æ–‡å®šä»·é¡µ
/zh/pricing        â†’ ä¸­æ–‡å®šä»·é¡µ
/blog/post-1       â†’ è‹±æ–‡åšå®¢
/zh/blog/post-1    â†’ ä¸­æ–‡åšå®¢
```

#### ç½‘ç«™é…ç½®

**æ–‡ä»¶**: `src/config/website.tsx`

```typescript
export const websiteConfig = {
  i18n: {
    defaultLocale: 'en',
    locales: {
      en: {
        flag: 'ğŸ‡ºğŸ‡¸',
        name: 'English',
        hreflang: 'en'
      },
      zh: {
        flag: 'ğŸ‡¨ğŸ‡³',
        name: 'ä¸­æ–‡',
        hreflang: 'zh-CN'
      }
    }
  }
};
```

**æ¥æº**: `src/config/website.tsx`

### ğŸ“ ç¿»è¯‘æ–‡ä»¶

#### æ–‡ä»¶ç»“æ„

```
messages/
â”œâ”€â”€ en.json       // è‹±æ–‡ç¿»è¯‘
â””â”€â”€ zh.json       // ä¸­æ–‡ç¿»è¯‘
```

**æ¥æº**: `messages/` ç›®å½•

#### ç¿»è¯‘å†…å®¹

**è‹±æ–‡**: `messages/en.json`

```json
{
  "Metadata": {
    "name": "MKSaaS - Next.js SaaS Starter Kit",
    "description": "Build your SaaS faster with Next.js 15",
    "title": "Next.js SaaS Starter Kit"
  },
  "PricePlans": {
    "free": {
      "name": "Free",
      "description": "Perfect for getting started"
    },
    "pro": {
      "name": "Pro",
      "description": "For professionals"
    },
    "lifetime": {
      "name": "Lifetime",
      "description": "One-time payment"
    }
  },
  "Mail": {
    "emailVerification": {
      "subject": "Verify your email",
      "previewText": "Click the link below to verify",
      "title": "Email Verification",
      "body": "Please verify your email address",
      "buttonText": "Verify Email"
    },
    "passwordReset": {
      "subject": "Reset your password",
      "title": "Password Reset"
    }
  }
  // ... æ›´å¤šç¿»è¯‘
}
```

**ä¸­æ–‡**: `messages/zh.json`

```json
{
  "Metadata": {
    "name": "MKSaaS - Next.js SaaS å¯åŠ¨å¥—ä»¶",
    "description": "ä½¿ç”¨ Next.js 15 æ›´å¿«åœ°æ„å»ºæ‚¨çš„ SaaS",
    "title": "Next.js SaaS å¯åŠ¨å¥—ä»¶"
  },
  "PricePlans": {
    "free": {
      "name": "å…è´¹ç‰ˆ",
      "description": "é€‚åˆå…¥é—¨ä½¿ç”¨"
    },
    "pro": {
      "name": "ä¸“ä¸šç‰ˆ",
      "description": "é€‚åˆä¸“ä¸šç”¨æˆ·"
    },
    "lifetime": {
      "name": "ç»ˆèº«ç‰ˆ",
      "description": "ä¸€æ¬¡æ€§ä»˜è´¹"
    }
  },
  "Mail": {
    "emailVerification": {
      "subject": "éªŒè¯æ‚¨çš„é‚®ç®±",
      "previewText": "ç‚¹å‡»ä¸‹æ–¹é“¾æ¥è¿›è¡ŒéªŒè¯",
      "title": "é‚®ç®±éªŒè¯",
      "body": "è¯·éªŒè¯æ‚¨çš„é‚®ç®±åœ°å€",
      "buttonText": "éªŒè¯é‚®ç®±"
    },
    "passwordReset": {
      "subject": "é‡ç½®å¯†ç ",
      "title": "å¯†ç é‡ç½®"
    }
  }
  // ... æ›´å¤šç¿»è¯‘
}
```

**æ¥æº**: `messages/en.json`, `messages/zh.json`

### ğŸ¯ å›½é™…åŒ–ä½¿ç”¨

#### 1. æœåŠ¡ç«¯ç»„ä»¶

```typescript
import { getTranslations } from 'next-intl/server';

export default async function PricingPage() {
  const t = await getTranslations('PricePlans');

  return (
    <div>
      <h1>{t('pro.name')}</h1>
      <p>{t('pro.description')}</p>
    </div>
  );
}
```

#### 2. å®¢æˆ·ç«¯ç»„ä»¶

```typescript
'use client';

import { useTranslations } from 'next-intl';

export function PricingCard() {
  const t = useTranslations('PricePlans');

  return (
    <div>
      <h2>{t('free.name')}</h2>
      <p>{t('free.description')}</p>
    </div>
  );
}
```

#### 3. è·¯ç”±å¯¼èˆª

**æ–‡ä»¶**: `src/i18n/navigation.ts`

```typescript
import { createNavigation } from 'next-intl/navigation';
import { routing } from './routing';

export const { Link, redirect, usePathname, useRouter } =
  createNavigation(routing);
```

**ä½¿ç”¨**:

```typescript
import { Link } from '@/i18n/navigation';

<Link href="/pricing">Pricing</Link>
// è‡ªåŠ¨æ·»åŠ è¯­è¨€å‰ç¼€: /zh/pricing (ä¸­æ–‡), /pricing (è‹±æ–‡)
```

**æ¥æº**: `src/i18n/navigation.ts` (åŸºäº next-intl è§„èŒƒ)

### ğŸ“§ å¤šè¯­è¨€é‚®ä»¶

#### Better Auth é‚®ä»¶é›†æˆ

**æ–‡ä»¶**: `src/lib/auth.ts`

```typescript
emailAndPassword: {
  enabled: true,
  requireEmailVerification: true,
  sendVerificationEmail: async ({ user, url, token }, request) => {
    // è·å–ç”¨æˆ·è¯­è¨€åå¥½
    const locale = request?.headers.get('accept-language')?.includes('zh')
      ? 'zh'
      : 'en';

    const translations = await getTranslations({ locale });

    await sendEmail({
      to: user.email,
      subject: translations('Mail.emailVerification.subject'),
      html: renderEmailTemplate('verification', {
        title: translations('Mail.emailVerification.title'),
        body: translations('Mail.emailVerification.body'),
        buttonText: translations('Mail.emailVerification.buttonText'),
        url
      })
    });
  },

  sendResetPassword: async ({ user, url, token }, request) => {
    const locale = detectLocale(request);
    const translations = await getTranslations({ locale });

    await sendEmail({
      to: user.email,
      subject: translations('Mail.passwordReset.subject'),
      html: renderEmailTemplate('reset-password', {
        title: translations('Mail.passwordReset.title'),
        url
      })
    });
  }
}
```

**æ¥æº**: `src/lib/auth.ts` (åŸºäºé¡¹ç›®é€»è¾‘)

**é‚®ä»¶æ¨¡æ¿**: `src/mail/templates/`

```
templates/
â”œâ”€â”€ verification.tsx          // éªŒè¯é‚®ä»¶æ¨¡æ¿
â”œâ”€â”€ reset-password.tsx        // å¯†ç é‡ç½®æ¨¡æ¿
â””â”€â”€ welcome.tsx               // æ¬¢è¿é‚®ä»¶æ¨¡æ¿
```

**æ¥æº**: `src/mail/templates/`

### ğŸ” æœç´¢å›½é™…åŒ–

#### Fumadocs ä¸­æ–‡åˆ†è¯

**æ–‡ä»¶**: `src/app/api/search/route.ts`

```typescript
import { createSearchAPI } from 'fumadocs-core/server';
import { createFromSource } from 'fumadocs-core/search/orama';
import { createTokenizer } from '@orama/tokenizers/mandarin';

export const GET = async (req: Request, { params }: { params: { locale: string } }) => {
  const { locale } = params;

  // ä¸­æ–‡ä½¿ç”¨ Mandarin tokenizer
  const mandarinTokenizer = locale === 'zh'
    ? await createTokenizer()
    : undefined;

  return createSearchAPI('advanced', {
    indexes: [
      createFromSource(source, (page) => ({
        title: page.data.title,
        content: page.data.content,
        description: page.data.description
      }))
    ],
    language: locale === 'zh'
      ? { tokenizer: mandarinTokenizer }
      : undefined,
    limit: 20
  });
};
```

**æ¥æº**: `src/app/api/search/route.ts` (åŸºäº Explore ä»£ç†æŠ¥å‘Š)

**ä¾èµ–**:

```json
{
  "@orama/orama": "^3.1.4",
  "@orama/tokenizers": "^3.1.4"
}
```

**æ¥æº**: `package.json`

### ğŸŒ SEO å›½é™…åŒ–

#### Metadata å›½é™…åŒ–

```typescript
import { getTranslations } from 'next-intl/server';

export async function generateMetadata({ params: { locale } }) {
  const t = await getTranslations({ locale, namespace: 'Metadata' });

  return {
    title: t('title'),
    description: t('description'),
    alternates: {
      canonical: `https://yourdomain.com/${locale}`,
      languages: {
        'en': 'https://yourdomain.com',
        'zh-CN': 'https://yourdomain.com/zh'
      }
    }
  };
}
```

#### Sitemap å›½é™…åŒ–

```typescript
// src/app/sitemap.ts
import { routing } from '@/i18n/routing';

export default function sitemap() {
  const pages = ['/', '/pricing', '/blog'];

  return routing.locales.flatMap((locale) =>
    pages.map((page) => ({
      url: `https://yourdomain.com/${locale === 'en' ? '' : locale}${page}`,
      lastModified: new Date(),
      changeFrequency: 'daily',
      priority: 0.8,
      alternateRefs: routing.locales.map((l) => ({
        href: `https://yourdomain.com/${l === 'en' ? '' : l}${page}`,
        hreflang: routing.locales[l].hreflang
      }))
    }))
  );
}
```

### ğŸ“Š å›½é™…åŒ–è¦†ç›–èŒƒå›´

| æ¨¡å— | è‹±æ–‡ | ä¸­æ–‡ | è¦†ç›–ç‡ |
|------|------|------|--------|
| UI ç»„ä»¶ | âœ… | âœ… | 100% |
| é‚®ä»¶æ¨¡æ¿ | âœ… | âœ… | 100% |
| é”™è¯¯æ¶ˆæ¯ | âœ… | âœ… | 100% |
| SEO Metadata | âœ… | âœ… | 100% |
| å®šä»·é¡µé¢ | âœ… | âœ… | 100% |
| åšå®¢å†…å®¹ | âœ… | âœ… | å–å†³äºå†…å®¹ |
| æ–‡æ¡£ | âœ… | âœ… | å–å†³äºå†…å®¹ |

### ğŸ¯ å›½é™…åŒ–æœ€ä½³å®è·µ

#### å·²å®æ–½

1. âœ… **è·¯ç”±å›½é™…åŒ–** - åŸºäºè·¯å¾„çš„è¯­è¨€åˆ‡æ¢
2. âœ… **å†…å®¹å›½é™…åŒ–** - å®Œæ•´çš„ç¿»è¯‘æ–‡ä»¶
3. âœ… **é‚®ä»¶å›½é™…åŒ–** - å¤šè¯­è¨€é‚®ä»¶æ¨¡æ¿
4. âœ… **SEO å›½é™…åŒ–** - hreflang å’Œ canonical
5. âœ… **æœç´¢å›½é™…åŒ–** - ä¸­æ–‡åˆ†è¯æ”¯æŒ
6. âœ… **æ—¥æœŸ/æ—¶é—´æœ¬åœ°åŒ–** - date-fns åº“

#### å»ºè®®å®æ–½

1. ğŸ”„ **è´§å¸æœ¬åœ°åŒ–** - æ ¹æ®åœ°åŒºæ˜¾ç¤ºä¸åŒè´§å¸
2. ğŸ”„ **æ•°å­—æ ¼å¼åŒ–** - æ ¹æ®è¯­è¨€æ ¼å¼åŒ–æ•°å­—
3. ğŸ”„ **æ—¶åŒºå¤„ç†** - æ˜¾ç¤ºç”¨æˆ·æœ¬åœ°æ—¶åŒº
4. ğŸ”„ **RTL æ”¯æŒ** - å³åˆ°å·¦è¯­è¨€ï¼ˆé˜¿æ‹‰ä¼¯è¯­ç­‰ï¼‰
5. ğŸ”„ **è¯­è¨€è‡ªåŠ¨æ£€æµ‹** - æ ¹æ®æµè§ˆå™¨è¯­è¨€è‡ªåŠ¨åˆ‡æ¢

### ğŸŒ æ·»åŠ æ–°è¯­è¨€

#### æ­¥éª¤

1. **æ·»åŠ ç¿»è¯‘æ–‡ä»¶**:
   ```bash
   messages/
   â”œâ”€â”€ en.json
   â”œâ”€â”€ zh.json
   â””â”€â”€ ja.json    # æ–°å¢æ—¥è¯­
   ```

2. **æ›´æ–°è·¯ç”±é…ç½®**:
   ```typescript
   export const routing = defineRouting({
     locales: ['en', 'zh', 'ja'],
     defaultLocale: 'en'
   });
   ```

3. **æ›´æ–°ç½‘ç«™é…ç½®**:
   ```typescript
   i18n: {
     locales: {
       en: { flag: 'ğŸ‡ºğŸ‡¸', name: 'English', hreflang: 'en' },
       zh: { flag: 'ğŸ‡¨ğŸ‡³', name: 'ä¸­æ–‡', hreflang: 'zh-CN' },
       ja: { flag: 'ğŸ‡¯ğŸ‡µ', name: 'æ—¥æœ¬èª', hreflang: 'ja' }
     }
   }
   ```

4. **ç¿»è¯‘æ‰€æœ‰å†…å®¹**:
   - å¤åˆ¶ `en.json` ä¸º `ja.json`
   - ç¿»è¯‘æ‰€æœ‰æ–‡æœ¬
   - æµ‹è¯•æ‰€æœ‰é¡µé¢

5. **æ›´æ–° SEO**:
   - æ·»åŠ  hreflang æ ‡ç­¾
   - æ›´æ–° sitemap
   - æäº¤åˆ°æœç´¢å¼•æ“

### ğŸ’° å›½é™…åŒ–ä¸æ”¯ä»˜

#### è´§å¸æœ¬åœ°åŒ–ï¼ˆå»ºè®®ï¼‰

```typescript
// å½“å‰: ä»…ç¾å…ƒ
price: {
  amount: 990,
  currency: 'USD'
}

// å»ºè®®: å¤šè´§å¸æ”¯æŒ
const currencyByLocale = {
  en: 'USD',
  zh: 'CNY',
  ja: 'JPY'
};

price: {
  amount: getLocalizedPrice(990, locale),
  currency: currencyByLocale[locale]
}
```

**Stripe æ”¯æŒ**: 140+ ç§è´§å¸

### ğŸ”§ å›½é™…åŒ–å·¥å…·

**ä¾èµ–**:

```json
{
  "next-intl": "^4.0.0",              // æ ¸å¿ƒå›½é™…åŒ–
  "use-intl": "^3.26.5",              // React Hook
  "@orama/tokenizers": "^3.1.4",     // ä¸­æ–‡åˆ†è¯
  "date-fns": "^4.1.0"               // æ—¥æœŸæœ¬åœ°åŒ–
}
```

**æ¥æº**: `package.json`

## ğŸ“ ä¿¡æ¯æ¥æº
- `src/i18n/routing.ts` - è·¯ç”±é…ç½®
- `src/i18n/navigation.ts` - å¯¼èˆªå·¥å…·
- `src/config/website.tsx` - è¯­è¨€é…ç½®
- `messages/en.json` - è‹±æ–‡ç¿»è¯‘
- `messages/zh.json` - ä¸­æ–‡ç¿»è¯‘
- `src/app/api/search/route.ts` - æœç´¢å›½é™…åŒ–
- `src/lib/auth.ts` - é‚®ä»¶å›½é™…åŒ–
- `package.json` - å›½é™…åŒ–ä¾èµ–
- next-intl å®˜æ–¹æ–‡æ¡£ - ä½¿ç”¨æŒ‡å—
