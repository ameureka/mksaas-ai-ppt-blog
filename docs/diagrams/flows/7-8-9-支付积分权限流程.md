# 7-8-9. æ”¯ä»˜ã€ç§¯åˆ†ã€æƒé™æµç¨‹å›¾

## 7. æ”¯ä»˜è®¢é˜…å®Œæ•´æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ’³ æ”¯ä»˜è®¢é˜…å®Œæ•´æµç¨‹ (Payment Flow)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç”¨æˆ·è®¿é—® /pricing
  â”‚
  â–¼
æ˜¾ç¤ºä¸‰å±‚ä»·æ ¼è¡¨
  â”‚
  â”œâ”€ Free (å·²ä½¿ç”¨ï¼Œæ˜¾ç¤º"å½“å‰è®¡åˆ’")
  â”œâ”€ Pro Monthly ($9.99/æœˆ) æˆ– Pro Yearly ($99/å¹´)
  â””â”€ Lifetime ($199 ä¸€æ¬¡æ€§)
  â”‚
  â–¼
ç”¨æˆ·æ˜¯å¦å·²ç™»å½•?
  â”‚
  â”œâ”€å¦â”€â–º "Please sign in to subscribe"
  â”‚      é‡å®šå‘åˆ° /auth/login
  â”‚
  â””â”€æ˜¯
    â”‚
    â–¼
  ç”¨æˆ·ç‚¹å‡» "Upgrade" / "Subscribe" æŒ‰é’®
    â”‚
    â–¼
  æ£€æŸ¥é‚®ç®±æ˜¯å¦å·²éªŒè¯
    â”‚
    â”œâ”€å¦â”€â–º "Please verify your email first"
    â”‚      æä¾›é‡æ–°å‘é€éªŒè¯é‚®ä»¶é€‰é¡¹
    â”‚
    â””â”€æ˜¯
      â”‚
      â–¼
    è°ƒç”¨ Server Action: createCheckoutSessionAction()
      â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         (Server-side Processing)  â”‚
                                   â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
    1ï¸âƒ£ éªŒè¯ç”¨æˆ·èº«ä»½
      â”‚
      â”œâ”€ ç¡®è®¤ userActionClient (éœ€è¦ç™»å½•)
      â”‚
      â””â”€ ç»§ç»­
      â”‚
      â–¼
    2ï¸âƒ£ è·å–æˆ–åˆ›å»º Stripe Customer
      â”‚
      â”œâ”€ å¦‚æœ user.customerId å­˜åœ¨:
      â”‚  â””â”€ ä½¿ç”¨æ—¢æœ‰çš„ customerId
      â”‚
      â”œâ”€ å¦‚æœä¸å­˜åœ¨:
      â”‚  â”œâ”€ è°ƒç”¨ stripe.customers.create({
      â”‚  â”‚   email: user.email,
      â”‚  â”‚   name: user.name
      â”‚  â”‚ })
      â”‚  â”‚
      â”‚  â”œâ”€ è·å¾— customerId
      â”‚  â”‚
      â”‚  â””â”€ ä¿å­˜åˆ°æ•°æ®åº“: UPDATE user SET customerId = ...
      â”‚
      â””â”€ ç»§ç»­
      â”‚
      â–¼
    3ï¸âƒ£ æ£€æŸ¥é‡å¤è´­ä¹° (ä»…é™ç»ˆèº«è®¡åˆ’)
      â”‚
      â”œâ”€ å¦‚æœé€‰æ‹©ç»ˆèº«è®¡åˆ’:
      â”‚  â”œâ”€ SELECT * FROM payment
      â”‚  â”‚  WHERE userId = ? AND scene = 'lifetime' AND status = 'paid'
      â”‚  â”‚
      â”‚  â”œâ”€ å¦‚æœå·²æœ‰ç»ˆèº«è®¡åˆ’:
      â”‚  â”‚  â””â”€ è¿”å›é”™è¯¯ "You already have lifetime plan"
      â”‚  â”‚
      â”‚  â””â”€ å¦‚æœæ²¡æœ‰: ç»§ç»­
      â”‚
      â””â”€ ç»§ç»­
      â”‚
      â–¼
    4ï¸âƒ£ ä»é…ç½®è·å– Stripe Price ID
      â”‚
      â”œâ”€ æŸ¥è¯¢ website.tsx é…ç½®
      â”‚  â”œâ”€ Pro Monthly: STRIPE_PRICE_PRO_MONTHLY
      â”‚  â”œâ”€ Pro Yearly: STRIPE_PRICE_PRO_YEARLY
      â”‚  â”œâ”€ Lifetime: STRIPE_PRICE_LIFETIME
      â”‚  â””â”€ Credits: STRIPE_PRICE_CREDIT_*
      â”‚
      â””â”€ ç»§ç»­
      â”‚
      â–¼
    5ï¸âƒ£ åˆ›å»º Stripe Checkout Session
      â”‚
      â”œâ”€ stripe.checkout.sessions.create({
      â”‚    customer: customerId,
      â”‚    mode: type === 'subscription' ? 'subscription' : 'payment',
      â”‚    line_items: [{
      â”‚      price: priceId,
      â”‚      quantity: 1
      â”‚    }],
      â”‚    success_url: '.../payment?session_id={CHECKOUT_SESSION_ID}',
      â”‚    cancel_url: '.../pricing'
      â”‚  })
      â”‚
      â”œâ”€ è·å¾—: session.id, session.url
      â”‚
      â””â”€ ç»§ç»­
      â”‚
      â–¼
    6ï¸âƒ£ ä¿å­˜æ”¯ä»˜è®°å½•åˆ°æ•°æ®åº“
      â”‚
      â”œâ”€ INSERT INTO payment (
      â”‚    id, userId, customerId, priceId,
      â”‚    type, scene, sessionId, status,
      â”‚    createdAt
      â”‚  ) VALUES (...)
      â”‚
      â”œâ”€ status: 'pending' (ç­‰å¾… Stripe webhook)
      â”‚
      â””â”€ ç»§ç»­
      â”‚
      â–¼
    7ï¸âƒ£ è¿”å› Stripe Checkout URL
      â”‚
      â””â”€ { redirectUrl: session.url }
      â”‚
      (Return to Client)
      â”‚
      â–¼
    è·å¾— Stripe Checkout URL
      â”‚
      â–¼
    é‡å®šå‘åˆ° Stripe Checkout
      â”‚
      â”œâ”€ window.location.href = 'https://checkout.stripe.com/...'
      â”‚
      â””â”€ ç”¨æˆ·ç¦»å¼€åº”ç”¨
      â”‚
      â–¼
    ç”¨æˆ·åœ¨ Stripe Checkout é¡µé¢
      â”‚
      â”œâ”€ æ˜¾ç¤ºæ”¯ä»˜æ‘˜è¦
      â”‚  â”œâ”€ è®¡åˆ’åç§°å’Œä»·æ ¼
      â”‚  â”œâ”€ è®¢é˜…å‘¨æœŸ (æœˆ/å¹´)
      â”‚  â””â”€ æ€»é‡‘é¢
      â”‚
      â”œâ”€ ç”¨æˆ·è¾“å…¥ä¿¡ç”¨å¡ä¿¡æ¯
      â”‚  â”œâ”€ å¡å·
      â”‚  â”œâ”€ æœ‰æ•ˆæœŸ
      â”‚  â”œâ”€ CVC
      â”‚  â””â”€ è´¦å•åœ°å€
      â”‚
      â””â”€ ç‚¹å‡» "Pay" æˆ– "Complete Order"
      â”‚
      â–¼
    Stripe å¤„ç†æ”¯ä»˜
      â”‚
      â”œâ”€ éªŒè¯ä¿¡ç”¨å¡
      â”‚ â””â”€ ä¸å¡å…¬å¸é€šä¿¡
      â”‚
      â”œâ”€ å¦‚æœå¤±è´¥:
      â”‚  â””â”€ æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
      â”‚     ç”¨æˆ·å¯ä»¥é‡è¯•æˆ–å–æ¶ˆ
      â”‚
      â”œâ”€ å¦‚æœæˆåŠŸ:
      â”‚  â”œâ”€ è®°å½•äº¤æ˜“
      â”‚  â”œâ”€ ç”Ÿæˆå‘ç¥¨
      â”‚  â””â”€ å‘é€ç¡®è®¤é‚®ä»¶
      â”‚
      â””â”€ å‘é€ webhook é€šçŸ¥
      â”‚
      â–¼
    Stripe Webhook å‘é€äº‹ä»¶
      â”‚
      â”œâ”€ event.type: 'checkout.session.completed'
      â”‚
      â””â”€ POST /api/webhooks/stripe
         â”œâ”€ éªŒè¯ webhook ç­¾å
         â”‚  â””â”€ stripe.webhooks.constructEvent()
         â”‚
         â””â”€ äº‹ä»¶å¤„ç† (è§ä¸‹æ–¹)
      â”‚
      â–¼
    å¤„ç† checkout.session.completed äº‹ä»¶
      â”‚
      â”œâ”€ 1ï¸âƒ£ æŸ¥æ‰¾ç›¸åº”çš„æ”¯ä»˜è®°å½•
      â”‚  â””â”€ SELECT * FROM payment WHERE sessionId = ?
      â”‚
      â”œâ”€ 2ï¸âƒ£ æ›´æ–°æ”¯ä»˜çŠ¶æ€ä¸º "å·²æ”¯ä»˜"
      â”‚  â””â”€ UPDATE payment SET status = 'paid', paid = true
      â”‚
      â”œâ”€ 3ï¸âƒ£ å¦‚æœæ˜¯è®¢é˜…:
      â”‚  â”œâ”€ ä¿å­˜ subscriptionId
      â”‚  â”œâ”€ è®¾ç½® periodStart / periodEnd
      â”‚  â””â”€ UPDATE payment SET subscriptionId = ..., interval = 'month'/'year'
      â”‚
      â”œâ”€ 4ï¸âƒ£ åˆ†é…ç§¯åˆ†
      â”‚  â”‚
      â”‚  â”œâ”€ å¦‚æœæ˜¯è®¢é˜…:
      â”‚  â”‚  â””â”€ INSERT INTO creditTransaction (
      â”‚  â”‚     type: 'SUBSCRIPTION_RENEWAL',
      â”‚  â”‚     amount: +1000,
      â”‚  â”‚     expirationDate: 30 days later
      â”‚  â”‚   )
      â”‚  â”‚
      â”‚  â”œâ”€ å¦‚æœæ˜¯ç»ˆèº«:
      â”‚  â”‚  â””â”€ INSERT INTO creditTransaction (
      â”‚  â”‚     type: 'LIFETIME_MONTHLY',
      â”‚  â”‚     amount: +1000,
      â”‚  â”‚     expirationDate: null (æ°¸ä¸è¿‡æœŸ)
      â”‚  â”‚   )
      â”‚  â”‚
      â”‚  â””â”€ å¦‚æœæ˜¯ç§¯åˆ†åŒ…:
      â”‚     â””â”€ INSERT INTO creditTransaction (
      â”‚        type: 'PURCHASE_PACKAGE',
      â”‚        amount: +500/1000/etc,
      â”‚        expirationDate: null
      â”‚      )
      â”‚
      â”œâ”€ 5ï¸âƒ£ æ›´æ–°ç”¨æˆ·ç§¯åˆ†ä½™é¢
      â”‚  â””â”€ UPDATE userCredit SET currentCredits = ...
      â”‚
      â”œâ”€ 6ï¸âƒ£ å‘é€æˆåŠŸé‚®ä»¶
      â”‚  â””â”€ sendEmail({
      â”‚     to: user.email,
      â”‚     template: 'paymentSuccess',
      â”‚     context: { planName, amount, ... }
      â”‚   })
      â”‚
      â””â”€ 7ï¸âƒ£ Webhook å¤„ç†å®Œæˆ
      â”‚
      â–¼
    ç”¨æˆ·é‡å®šå‘å›åº”ç”¨
      â”‚
      â”œâ”€ Stripe é‡å®šå‘: GET /payment?session_id=xxx
      â”‚
      â””â”€ æµè§ˆå™¨å‘é€è¯·æ±‚
      â”‚
      â–¼
    æ£€æŸ¥æ”¯ä»˜å®ŒæˆçŠ¶æ€
      â”‚
      â”œâ”€ é¡µé¢åŠ è½½ â†’ usePaymentCompletion() Hook
      â”‚
      â”œâ”€ è¯¥ Hook è½®è¯¢: checkPaymentCompletionAction()
      â”‚  â”œâ”€ æ¯ 2 ç§’æ£€æŸ¥ä¸€æ¬¡
      â”‚  â”œâ”€ æ£€æŸ¥æ”¯ä»˜è®°å½•çŠ¶æ€
      â”‚  â””â”€ æœ€å¤šè½®è¯¢ 30 æ¬¡ (1 åˆ†é’Ÿ)
      â”‚
      â”œâ”€ æ”¯ä»˜æˆåŠŸ (status = 'paid')
      â”‚  â”œâ”€ æ˜¾ç¤ºæˆåŠŸæç¤º
      â”‚  â”œâ”€ React Query åˆ·æ–° useCurrentPlan()
      â”‚  â””â”€ 3 ç§’åé‡å®šå‘åˆ° /dashboard
      â”‚
      â”œâ”€ æ”¯ä»˜å¤±è´¥ (status = 'pending' è¶…æ—¶)
      â”‚  â”œâ”€ æ˜¾ç¤ºå¤±è´¥æç¤º
      â”‚  â””â”€ æä¾›é‡è¯•é“¾æ¥
      â”‚
      â””â”€ ç»§ç»­
      â”‚
      â–¼
    âœ… æ”¯ä»˜å®Œæˆï¼
      â”‚
      â”œâ”€ ç”¨æˆ·é‡å®šå‘åˆ°ä»ªè¡¨æ¿
      â”‚
      â”œâ”€ æ˜¾ç¤ºæ–°çš„è®¡åˆ’ä¿¡æ¯
      â”‚
      â””â”€ ç”¨æˆ·å¯ä»¥å¼€å§‹ä½¿ç”¨æ–°è®¡åˆ’
```

## 8. ç§¯åˆ†ç”Ÿå‘½å‘¨æœŸæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ğŸ’° ç§¯åˆ†ç³»ç»Ÿå®Œæ•´ç”Ÿå‘½å‘¨æœŸ (Credits Lifecycle)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç”¨æˆ·æ³¨å†Œ
  â”‚
  â””â”€â–º creditTransaction Type: REGISTER_GIFT
      â”œâ”€ amount: +50
      â”œâ”€ expirationDate: 30 days from now
      â””â”€ userCredit.currentCredits: 50


ç”¨æˆ·è®¢é˜… Pro è®¡åˆ’ (æœˆåº¦)
  â”‚
  â”œâ”€ æ”¯ä»˜æˆåŠŸ (Webhook: checkout.session.completed)
  â”‚
  â””â”€â–º creditTransaction Type: SUBSCRIPTION_RENEWAL
      â”œâ”€ amount: +1000
      â”œâ”€ expirationDate: 30 days from now
      â””â”€ userCredit.currentCredits: 1050


ç”¨æˆ·ä½¿ç”¨ AI åŠŸèƒ½ (å›¾ç‰‡ç”Ÿæˆã€å¯¹è¯ç­‰)
  â”‚
  â”œâ”€ è°ƒç”¨ API: POST /api/generate-images
  â”‚
  â”œâ”€ ç³»ç»Ÿè®¡ç®—ç§¯åˆ†æ¶ˆè€—: credits_required = 50
  â”‚
  â”œâ”€ è°ƒç”¨ consumeCreditsAction()
  â”‚  â”œâ”€ æ£€æŸ¥: currentCredits >= 50?
  â”‚  â”‚
  â”‚  â”œâ”€ æ˜¯: ç»§ç»­
  â”‚  â”‚  â””â”€ æ‰§è¡Œ AI åŠŸèƒ½
  â”‚  â”‚
  â”‚  â””â”€ å¦: è¿”å›é”™è¯¯ "Insufficient credits"
  â”‚     æ˜¾ç¤º"ç§¯åˆ†ä¸è¶³ï¼Œè¯·è´­ä¹°"
  â”‚
  â””â”€â–º creditTransaction Type: USAGE
      â”œâ”€ amount: -50
      â”œâ”€ expirationDate: null (æ¶ˆè€—ä¸è¿‡æœŸ)
      â”œâ”€ description: 'Image generation'
      â””â”€ userCredit.currentCredits: 1000


æ¯æœˆè‡ªåŠ¨åˆ·æ–° (Free ç”¨æˆ·)
  â”‚
  â”œâ”€ Cron Job: æ¯å¤©å‡Œæ™¨è¿è¡Œ
  â”‚
  â”œâ”€ æ£€æŸ¥ Free ç”¨æˆ·ä¸Šæ¬¡åˆ·æ–°æ—¶é—´
  â”‚  â””â”€ IF lastRefreshAt < (now - 30 days)
  â”‚
  â””â”€â–º creditTransaction Type: MONTHLY_REFRESH
      â”œâ”€ amount: +50
      â”œâ”€ expirationDate: 30 days from now
      â””â”€ userCredit.currentCredits: += 50


ç”¨æˆ·è´­ä¹°ç§¯åˆ†åŒ… ($9.99 â†’ +500 ç§¯åˆ†)
  â”‚
  â”œâ”€ æ”¯ä»˜æˆåŠŸ (Webhook: invoice.payment_succeeded)
  â”‚
  â””â”€â–º creditTransaction Type: PURCHASE_PACKAGE
      â”œâ”€ amount: +500
      â”œâ”€ expirationDate: null (æ°¸ä¸è¿‡æœŸ)
      â”œâ”€ description: 'Purchase credit package'
      â””â”€ userCredit.currentCredits: += 500


ç”¨æˆ·å‡çº§åˆ°ç»ˆèº«è®¡åˆ’ ($199)
  â”‚
  â”œâ”€ æ”¯ä»˜æˆåŠŸ (Webhook: checkout.session.completed)
  â”‚
  â”œâ”€ é¦–æ¬¡å‡çº§æ—¶:
  â”‚  â””â”€â–º creditTransaction Type: LIFETIME_MONTHLY
  â”‚      â”œâ”€ amount: +1000
  â”‚      â”œâ”€ expirationDate: null (æ°¸ä¸è¿‡æœŸ)
  â”‚      â””â”€ userCredit.currentCredits: += 1000
  â”‚
  â””â”€ æ¯ä¸ªæœˆè‡ªåŠ¨è¡¥å……:
     â”œâ”€ Cron Job: monthly-credits-distribution
     â”‚
     â””â”€â–º creditTransaction Type: LIFETIME_MONTHLY
         â”œâ”€ amount: +1000
         â”œâ”€ expirationDate: null
         â””â”€ userCredit.currentCredits: += 1000


ç§¯åˆ†å³å°†è¿‡æœŸæé†’ (7 å¤©å‰)
  â”‚
  â”œâ”€ Cron Job: æ¯å¤©è¿è¡Œ
  â”‚
  â”œâ”€ æ£€æŸ¥ creditTransaction è¡¨
  â”‚  â””â”€ WHERE expirationDate = today + 7 days
  â”‚
  â””â”€â–º å‘é€é‚®ä»¶æé†’
      â”œâ”€ æ¨¡æ¿: 'creditsExpiringSoon'
      â””â”€ å†…å®¹: "æ‚¨çš„ {amount} ç§¯åˆ†å°†åœ¨ 7 å¤©åè¿‡æœŸ"


ç§¯åˆ†è¿‡æœŸå¤„ç†
  â”‚
  â”œâ”€ Cron Job: credit:expire (æ¯å¤©å‡Œæ™¨è¿è¡Œ)
  â”‚
  â”œâ”€ 1ï¸âƒ£ æŸ¥è¯¢æ‰€æœ‰å·²è¿‡æœŸçš„äº¤æ˜“
  â”‚  â””â”€ WHERE expirationDate <= today AND expirationDateProcessedAt IS NULL
  â”‚
  â”œâ”€ 2ï¸âƒ£ å¯¹æ¯æ¡äº¤æ˜“å¤„ç†:
  â”‚  â”‚
  â”‚  â”œâ”€ åˆ›å»ºå¯¹åº”çš„ EXPIRE äº¤æ˜“
  â”‚  â”‚  â””â”€ creditTransaction(
  â”‚  â”‚     type: 'EXPIRE',
  â”‚  â”‚     amount: -(åŸå§‹ amount),
  â”‚  â”‚     description: 'Credits expired'
  â”‚  â”‚   )
  â”‚  â”‚
  â”‚  â””â”€ æ ‡è®°ä¸ºå·²å¤„ç†
  â”‚     â””â”€ UPDATE expirationDateProcessedAt = now()
  â”‚
  â”œâ”€ 3ï¸âƒ£ é‡æ–°è®¡ç®—æ€»ç§¯åˆ†
  â”‚  â””â”€ UPDATE userCredit SET currentCredits = SUM(...)
  â”‚
  â””â”€â–º å‘é€è¿‡æœŸé€šçŸ¥é‚®ä»¶
      â””â”€ æ¨¡æ¿: 'creditsExpired'


ç”¨æˆ·è®¿é—® /settings/credits
  â”‚
  â”œâ”€ æ˜¾ç¤ºå½“å‰ç§¯åˆ†ä½™é¢
  â”‚  â””â”€ userCredit.currentCredits
  â”‚
  â”œâ”€ æ˜¾ç¤ºç§¯åˆ†æ˜ç»†è¡¨
  â”‚  â”œâ”€ æ—¥æœŸ | ç±»å‹ | é‡‘é¢ | æ¥æº | è¿‡æœŸæ—¥æœŸ | çŠ¶æ€
  â”‚  â”‚
  â”‚  â”œâ”€ æ³¨å†Œèµ é€   +50   30 å¤©å      å·²è¿‡æœŸ
  â”‚  â”œâ”€ è®¢é˜…ç»­æœŸ  +1000  30 å¤©å      æœ‰æ•ˆ
  â”‚  â”œâ”€ ä½¿ç”¨æ¶ˆè€—   -50   -           å·²ä½¿ç”¨
  â”‚  â”œâ”€ ç»ˆèº«è®¡åˆ’  +1000  æ°¸ä¸è¿‡æœŸ    æœ‰æ•ˆ
  â”‚  â””â”€ å·²è¿‡æœŸ    -280   -           å·²è¿‡æœŸ
  â”‚
  â”œâ”€ è´­ä¹°ç§¯åˆ†åŒ…æŒ‰é’®
  â”‚  â””â”€ å¯é€‰åŒ…: 500ç§¯åˆ†/$9.99, 1000ç§¯åˆ†/$19.99, ç­‰
  â”‚
  â””â”€ ç»­æœŸè¯´æ˜
     â””â”€ "ç§¯åˆ†åœ¨ 30 å¤©åè‡ªåŠ¨è¿‡æœŸ"


ç§¯åˆ†æŸ¥è¯¢å’Œç»Ÿè®¡
  â”‚
  â”œâ”€ useCredits() Hook
  â”‚  â”œâ”€ å®æ—¶è·å–å½“å‰ç§¯åˆ†ä½™é¢
  â”‚  â””â”€ React Query ç¼“å­˜
  â”‚
  â”œâ”€ useCreditBalance() Hook
  â”‚  â””â”€ è¯¦ç»†ä½™é¢ä¿¡æ¯ (currentCredits, pendingExpiration, ç­‰)
  â”‚
  â”œâ”€ useCreditTransactions() Hook
  â”‚  â””â”€ äº¤æ˜“å†å²è¡¨ (åˆ†é¡µã€æœç´¢ã€æ’åº)
  â”‚
  â””â”€ useCreditStats() Hook
     â””â”€ ç»Ÿè®¡ä¿¡æ¯ (æœ¬æœˆä½¿ç”¨, æœ¬æœˆè·å¾—, ç­‰)


ç§¯åˆ†ç®¡ç†æœ€ä½³å®è·µ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. æ‰£ç§¯åˆ†æ—¶çš„åŸå­æ€§
   â”œâ”€ BEGIN TRANSACTION
   â”œâ”€ SELECT currentCredits FOR UPDATE (è¡Œé”)
   â”œâ”€ IF currentCredits >= amount:
   â”‚  â”œâ”€ INSERT creditTransaction
   â”‚  â””â”€ UPDATE userCredit
   â”œâ”€ ELSE:
   â”‚  â””â”€ ROLLBACK (ä½™é¢ä¸è¶³)
   â””â”€ COMMIT

2. é˜²æ­¢é‡å¤æ¶ˆè€—
   â”œâ”€ æ¯æ¡ creditTransaction æœ‰å”¯ä¸€ ID
   â”œâ”€ API å¹‚ç­‰æ€§æ£€æŸ¥
   â””â”€ é€šè¿‡ requestId å»é‡

3. ç§¯åˆ†è¿‡æœŸç­–ç•¥
   â”œâ”€ è‡ªåŠ¨è¿‡æœŸè®¡åˆ’ä»»åŠ¡
   â”œâ”€ æå‰ 7 å¤©å‘é€æé†’é‚®ä»¶
   â””â”€ å¤„ç†å®Œæˆåæ ‡è®° expirationDateProcessedAt

4. ç›‘æ§å’Œå‘Šè­¦
   â”œâ”€ å¼‚å¸¸çš„å¤§é¢æ¶ˆè€—
   â”œâ”€ é‡å¤æ¶ˆè€—åŒä¸€åŠŸèƒ½
   â””â”€ ç§¯åˆ†ä¸¢å¤±æˆ–ä¸ä¸€è‡´
```

## 9. ç”¨æˆ·æƒé™æ£€æŸ¥æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 ğŸ” ç”¨æˆ·æƒé™æ£€æŸ¥å®Œæ•´æµç¨‹ (Authorization Flow)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸‰ä¸ªåœ°æ–¹:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. é¡µé¢è·¯ç”±å±‚ (Page Routing)     - ä¸­é—´ä»¶ + é‡å®šå‘                          â”‚
â”‚ 2. Server Action å±‚ (Actions)    - æƒé™éªŒè¯                                  â”‚
â”‚ 3. API è·¯ç”±å±‚ (API Routes)       - Bearer Token éªŒè¯                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
æƒé™æ£€æŸ¥å±‚çº§ 1: é¡µé¢è·¯ç”±ä¸­é—´ä»¶ (middleware.ts)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ç”¨æˆ·è®¿é—® URL
  â”‚
  â–¼
è¯·æ±‚é€šè¿‡ä¸­é—´ä»¶ (middleware.ts)
  â”‚
  â–¼
1ï¸âƒ£ æå–å½“å‰è·¯ç”±è·¯å¾„
  â”‚
  â””â”€ const pathname = request.nextUrl.pathname
  â”‚
  â–¼
2ï¸âƒ£ è·å–ä¼šè¯ (ä» Cookie)
  â”‚
  â””â”€ const session = await auth.api.getSession({
       headers: request.headers
     })
  â”‚
  â–¼
3ï¸âƒ£ æ£€æŸ¥æ˜¯å¦éœ€è¦ç™»å½•
  â”‚
  â”œâ”€ IF pathname åŒ¹é… /protected/* æˆ– /dashboard/*:
  â”‚  â”‚
  â”‚  â”œâ”€ IF !session?.user:
  â”‚  â”‚  â””â”€ é‡å®šå‘åˆ° /auth/login?callbackUrl={pathname}
  â”‚  â”‚
  â”‚  â””â”€ ç»§ç»­
  â”‚
  â””â”€ ç»§ç»­
  â”‚
  â–¼
4ï¸âƒ£ æ£€æŸ¥ç”¨æˆ·ç¦ç”¨çŠ¶æ€
  â”‚
  â”œâ”€ IF session?.user?.banned === true:
  â”‚  â””â”€ é‡å®šå‘åˆ° /auth/error?error=banned
  â”‚
  â””â”€ ç»§ç»­
  â”‚
  â–¼
5ï¸âƒ£ æ£€æŸ¥æ˜¯å¦éœ€è¦ç®¡ç†å‘˜æƒé™
  â”‚
  â”œâ”€ IF pathname åŒ¹é… /admin/*:
  â”‚  â”‚
  â”‚  â”œâ”€ IF session?.user?.role !== 'admin':
  â”‚  â”‚  â””â”€ é‡å®šå‘åˆ° / (é¦–é¡µ)
  â”‚  â”‚
  â”‚  â””â”€ ç»§ç»­
  â”‚
  â””â”€ ç»§ç»­
  â”‚
  â–¼
6ï¸âƒ£ å…è®¸è¯·æ±‚ç»§ç»­
  â”‚
  â””â”€ return NextResponse.next()
  â”‚
  â–¼
âœ… è¯·æ±‚é€šè¿‡ä¸­é—´ä»¶ï¼Œç»§ç»­åˆ°é¡µé¢å¤„ç†


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
æƒé™æ£€æŸ¥å±‚çº§ 2: Server Action æƒé™æ¨¡å‹
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

å®¢æˆ·ç«¯è°ƒç”¨ Server Action
  â”‚
  â”œâ”€ actionClient.action()           # ä¸éœ€è¦è®¤è¯
  â”‚  â””â”€ ç¤ºä¾‹: validateCaptchaAction, sendMessageAction
  â”‚
  â”œâ”€ userActionClient.action()       # éœ€è¦ç”¨æˆ·è®¤è¯
  â”‚  â”‚
  â”‚  â”œâ”€ è‡ªåŠ¨ä»ä¼šè¯ä¸­è¯»å– userId
  â”‚  â”œâ”€ ç¤ºä¾‹: consumeCreditsAction, subscribeNewsletterAction
  â”‚  â”‚
  â”‚  â””â”€ IF !session?.user:
  â”‚     â””â”€ è¿”å›é”™è¯¯ "Unauthorized"
  â”‚
  â””â”€ adminActionClient.action()      # ä»…é™ç®¡ç†å‘˜
     â”‚
     â”œâ”€ æ£€æŸ¥: session?.user?.role === 'admin'
     â”œâ”€ ç¤ºä¾‹: getUsersAction, banUserAction
     â”‚
     â””â”€ IF user.role !== 'admin':
        â””â”€ è¿”å›é”™è¯¯ "Forbidden: Admin access required"


ç¤ºä¾‹ 1: userActionClient
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const consumeCreditsAction = userActionClient
  .schema(consumeCreditsSchema)
  .action(async ({ parsedInput, ctx }) => {
    // ctx.user è‡ªåŠ¨ä»ä¼šè¯ä¸­æå– (userActionClient ç¡®ä¿)
    const { userId } = ctx.user

    // ç”¨æˆ·åªèƒ½æ¶ˆè´¹è‡ªå·±çš„ç§¯åˆ†
    if (parsedInput.userId !== userId) {
      throw new Error("Cannot access other user's credits")
    }

    // åç»­çš„ä¸šåŠ¡é€»è¾‘...
  })


ç¤ºä¾‹ 2: adminActionClient
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const banUserAction = adminActionClient
  .schema(banUserSchema)
  .action(async ({ parsedInput, ctx }) => {
    // ctx.user è‡ªåŠ¨ä»ä¼šè¯ä¸­æå–ï¼Œä¸”å·²éªŒè¯ role === 'admin'
    const { user } = ctx

    // ç»§ç»­å¤„ç†ç¦ç”¨ç”¨æˆ·çš„é€»è¾‘
    // ...
  })


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
æƒé™æ£€æŸ¥å±‚çº§ 3: åŠŸèƒ½çº§æƒé™æ£€æŸ¥ (checkPremiumAccess)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

æŸäº›åŠŸèƒ½éœ€è¦ç‰¹å®šçš„æ”¯ä»˜è®¡åˆ’ (Premium åŠŸèƒ½)
  â”‚
  â–¼
åœ¨ Server Action ä¸­è°ƒç”¨ checkPremiumAccess()
  â”‚
  â”œâ”€ const hasAccess = await checkPremiumAccess({
  â”‚   userId: user.id,
  â”‚   feature: 'advanced-ai'  // æˆ–å…¶ä»–åŠŸèƒ½æ ‡è¯†
  â”‚ })
  â”‚
  â–¼
1ï¸âƒ£ è·å–ç”¨æˆ·å½“å‰è®¡åˆ’
  â”‚
  â”œâ”€ æŸ¥è¯¢ payment è¡¨
  â”‚  â””â”€ WHERE userId = ? AND status = 'paid'
  â”‚     ORDER BY createdAt DESC LIMIT 1
  â”‚
  â””â”€ è·å¾— currentPlan (Free, Pro, Lifetime)
  â”‚
  â–¼
2ï¸âƒ£ æ£€æŸ¥è®¡åˆ’æ˜¯å¦æ”¯æŒæ­¤åŠŸèƒ½
  â”‚
  â”œâ”€ ä» price-config.ts è·å–åŠŸèƒ½æ˜ å°„
  â”‚  â””â”€ Free: ['basic-ai']
  â”‚     Pro: ['basic-ai', 'advanced-ai']
  â”‚     Lifetime: ['basic-ai', 'advanced-ai', 'premium-ai']
  â”‚
  â”œâ”€ IF currentPlan.features.includes(feature):
  â”‚  â””â”€ return true (æœ‰æƒé™)
  â”‚
  â””â”€ ELSE:
     â””â”€ return false (æ— æƒé™)
  â”‚
  â–¼
3ï¸âƒ£ å¦‚æœæ— æƒé™
  â”‚
  â”œâ”€ è¿”å›é”™è¯¯ "Upgrade to Pro to access this feature"
  â”‚
  â”œâ”€ æˆ–è¿”å›ä¿¡æ¯: {
  â”‚   hasAccess: false,
  â”‚   requiredPlan: 'Pro',
  â”‚   upgradeCost: '$9.99/month'
  â”‚ }
  â”‚
  â””â”€ å®¢æˆ·ç«¯æ˜¾ç¤ºå‡çº§æç¤º


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
å®Œæ•´æƒé™æ£€æŸ¥æµç¨‹ç¤ºä¾‹: åˆ›å»ºé«˜çº§ AI èŠå¤©
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ç”¨æˆ·åœ¨ä»ªè¡¨æ¿ç‚¹å‡» "é«˜çº§ AI èŠå¤©"
  â”‚
  â–¼
è°ƒç”¨ Client: createAdvancedChatAction()
  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        (Server-side)         â”‚
                              â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
1ï¸âƒ£ userActionClient è‡ªåŠ¨éªŒè¯ç”¨æˆ·å·²ç™»å½•
  â”‚
  â”œâ”€ IF !session?.user:
  â”‚  â””â”€ è¿”å› "Unauthorized"
  â”‚
  â””â”€ ç»§ç»­ (userId å·²ä»ä¼šè¯ä¸­è¯»å–)
  â”‚
  â–¼
2ï¸âƒ£ æ£€æŸ¥ç”¨æˆ·æ˜¯å¦è¢«ç¦ç”¨
  â”‚
  â”œâ”€ SELECT * FROM user WHERE id = ?
  â”‚
  â”œâ”€ IF user.banned:
  â”‚  â””â”€ è¿”å› "Account banned"
  â”‚
  â””â”€ ç»§ç»­
  â”‚
  â–¼
3ï¸âƒ£ æ£€æŸ¥æ˜¯å¦æœ‰é«˜çº§æƒé™
  â”‚
  â”œâ”€ const hasAccess = await checkPremiumAccess({
  â”‚   userId,
  â”‚   feature: 'advanced-ai'
  â”‚ })
  â”‚
  â”œâ”€ IF !hasAccess:
  â”‚  â””â”€ è¿”å› {
  â”‚     error: "Upgrade to Pro for advanced AI",
  â”‚     requiredPlan: "Pro"
  â”‚   }
  â”‚
  â””â”€ ç»§ç»­
  â”‚
  â–¼
4ï¸âƒ£ æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„ç§¯åˆ†
  â”‚
  â”œâ”€ SELECT currentCredits FROM userCredit WHERE userId = ?
  â”‚
  â”œâ”€ credits_required = 50
  â”‚
  â”œâ”€ IF currentCredits < credits_required:
  â”‚  â””â”€ è¿”å› "Insufficient credits. Please purchase more"
  â”‚
  â””â”€ ç»§ç»­
  â”‚
  â–¼
5ï¸âƒ£ æ‰§è¡Œä¸šåŠ¡é€»è¾‘ (åˆ›å»ºé«˜çº§èŠå¤©)
  â”‚
  â”œâ”€ æ¶ˆè´¹ç§¯åˆ†
  â”œâ”€ è°ƒç”¨ AI API
  â””â”€ ä¿å­˜èŠå¤©å†å²
  â”‚
  â–¼
âœ… æƒé™æ£€æŸ¥å…¨éƒ¨é€šè¿‡ï¼Œæ“ä½œæˆåŠŸ


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
æƒé™æ£€æŸ¥å¤±è´¥çš„é”™è¯¯å“åº”
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€ æœªç™»å½•
â”‚  â””â”€ çŠ¶æ€: 401 Unauthorized
â”‚     å“åº”: { error: "Please sign in first" }
â”‚     å¤„ç†: é‡å®šå‘åˆ° /auth/login

â”œâ”€ è´¦æˆ·è¢«ç¦ç”¨
â”‚  â””â”€ çŠ¶æ€: 403 Forbidden
â”‚     å“åº”: { error: "Account banned", reason: "...", expires: "..." }
â”‚     å¤„ç†: æ˜¾ç¤ºç¦ç”¨é€šçŸ¥

â”œâ”€ æ— ç®¡ç†å‘˜æƒé™
â”‚  â””â”€ çŠ¶æ€: 403 Forbidden
â”‚     å“åº”: { error: "Admin access required" }
â”‚     å¤„ç†: é‡å®šå‘åˆ°é¦–é¡µ

â”œâ”€ éœ€è¦å‡çº§è®¡åˆ’
â”‚  â””â”€ çŠ¶æ€: 402 Payment Required
â”‚     å“åº”: {
â”‚       error: "Feature requires Pro plan",
â”‚       requiredPlan: "Pro",
â”‚       upgradeCost: "$9.99/month"
â”‚     }
â”‚     å¤„ç†: æ˜¾ç¤ºå‡çº§æç¤ºå¡ç‰‡

â””â”€ ç§¯åˆ†ä¸è¶³
   â””â”€ çŠ¶æ€: 402 Payment Required
      å“åº”: {
        error: "Insufficient credits",
        required: 50,
        available: 20,
        deficit: 30
      }
      å¤„ç†: æ˜¾ç¤ºè´­ä¹°ç§¯åˆ†åŒ…çš„é€‰é¡¹
```

---

**å…³é”®å®‰å…¨è¦ç‚¹**:
- ä¸‰å±‚æƒé™æ¨¡å‹ï¼šé¡µé¢ä¸­é—´ä»¶ â†’ Server Action â†’ åŠŸèƒ½æ£€æŸ¥
- æ‰€æœ‰æƒé™æ£€æŸ¥éƒ½åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œï¼Œå®¢æˆ·ç«¯æ— æ³•ç»•è¿‡
- ä¸åŒçš„ actionClient ç¡®ä¿ä¸åŒçº§åˆ«çš„æƒé™éš”ç¦»
- ç¦ç”¨ç”¨æˆ·çš„æ‰€æœ‰ä¼šè¯ç«‹å³å¤±æ•ˆ
- æ•æ„Ÿæ“ä½œ (å¦‚åˆ é™¤è´¦æˆ·) éœ€è¦é¢å¤–éªŒè¯ (å¦‚é‚®ç®±ç¡®è®¤)
